
### –ù–∞ –ø–æ–¥—É–º–∞—Ç—å:

---

- –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –≤ –Ω–∞—à—É —Å–∏—Å—Ç–µ–º—É –≤–≤–µ—Å—Ç–∏ —Ç–∏–ø Bool? –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–¥—Ö–æ–¥—è—â–∏–º –æ–±—Ä–∞–∑–æ–º.  –ë—É–¥–µ—Ç –ª–∏ –∞–Ω–∞–ª–∏–∑ –±–æ–ª–µ–µ –ø–æ–ª–Ω—ã–º, –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º? </br>

–ü–æ–ø—Ä–æ–±—É–µ–º –≤–Ω–µ—Å—Ç–∏ –≤ –∏–º–µ—é—â—É—é—Å—è —Å–∏—Å—Ç–µ–º—É —Ç–∏–ø `bool` –¥–ª—è –±—É–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—ã—Ä–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –∏ —É—Å–ª–æ–≤–∏—è—Ö —Ü–∏–∫–ª–æ–≤/–≤–µ—Ç–≤–ª–µ–Ω–∏–π. </br>

–¢–∞–∫–∂–µ —Ä–∞–∑–¥–µ–ª–∏–º —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π (`+, -, *, /, >, ==`) –æ—Ç–¥–µ–ª—å–Ω–æ –Ω–∞: 
 - `==` - —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `bool` –∏ —Ç—Ä–µ–±—É–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ç–∏–ø—ã –æ–ø–µ—Ä–∞–Ω–¥–æ–≤;
 - `>` - —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `bool` –∏ —Ç—Ä–µ–±—É–µ—Ç –æ–ø–µ—Ä–∞–Ω–¥—ã —Ç–∏–ø–∞ `bool`;
 - –û—Å—Ç–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ—Ç–Ω–µ—Å—ë–º –∫ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º (–¥–∞, –¥–æ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å * –∫–∞–∫ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ò, —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –Ω–µ–ª—å–∑—è, —É–∂ –Ω–µ –æ–±–µ—Å—Å—É–¥—å—Ç–µ).

–ü–æ–¥–æ–±–Ω–∞—è –ø—Ä–æ—Å—Ç–µ–π—à–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª–∏—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –ø–æ–ª–Ω–æ—Ç—É –∞–Ω–∞–ª–∏–∑–∞ (—Ç.–∫. –≤ —É—Å–ª–æ–≤–∏—è—Ö —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `bool` –∏ –º—ã —Å–º–æ–∂–µ–º –≤—ã—è–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –æ—à–∏–±–∫–∏ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏).</br>

| code                                         | type                                                             |
|----------------------------------------------|------------------------------------------------------------------|
| $I$                                          | $‚ü¶I‚üß = int$                                                      |
| $B$                                          | $‚ü¶B‚üß = bool$                                                     |
| $E_1 == E_2$                                 | $‚ü¶E_1‚üß = ‚ü¶E_2‚üß \land ‚ü¶E_1 == E_2‚üß = bool$                        |
| $E_1 > E_2$                                  | $‚ü¶E_1‚üß = ‚ü¶E_2‚üß = ‚ü¶E_1 > E_2‚üß = bool$                             |
| $E_1 \ mathOper \ E_1$                       | $‚ü¶E_1‚üß = ‚ü¶E_2‚üß = ‚ü¶E_1 mathOper E_2‚üß = int$                       |
| $input$                                      | $‚ü¶input‚üß = int$                                                  |
| $X = E$                                      | $‚ü¶X‚üß = ‚ü¶E‚üß$                                                      |
| $output \ E$                                 | $‚ü¶E‚üß = int$                                                      |
| $if \ (E) \ \{ S \}$                         | $‚ü¶E‚üß = bool$                                                     |
| $if \ (E) \ \{ S \} \ else \ \{ S \}$        | $‚ü¶E‚üß = bool$                                                     |
| $while(E) \ \{ S \}$                         | $‚ü¶E‚üß = bool$                                                     |
| $f(X_1, \dots, X_N) \ \{ \dots return E; \}$ | $‚ü¶f‚üß = (‚ü¶X_1‚üß, \dots, ‚ü¶X_N‚üß) \rightarrow ‚ü¶E‚üß$                    |
| $(E)(E_1, \dots, E_N)$                       | $‚ü¶E‚üß = (‚ü¶E_1‚üß, \dots, ‚ü¶E_N‚üß) \rightarrow ‚ü¶(E)(E_1, \dots, E_N)‚üß$ |
| $\\& E$                                      | $‚ü¶\\& E‚üß = \\& ‚ü¶E‚üß$                                              |
| $alloc \ E$                                  | $‚ü¶alloc \ E‚üß = \\& ‚ü¶E‚üß$                                          |
| $null$                                       | $‚ü¶null‚üß = \\& \alpha$                                            |
| $*E$                                         | $‚ü¶E‚üß = \\& ‚ü¶*E‚üß$                                                 |
| $*X = E$                                     | $‚ü¶X‚üß = \\& ‚ü¶E‚üß$                                                  |



–ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏ –¥–∞–ª—å—à–µ —É–≤–µ–ª–∏—á–∏—Ç—å –ø–æ–ª–Ω–æ—Ç—É –∞–Ω–∞–ª–∏–∑–∞ –ø—É—Ç—ë–º –≤–≤–µ–¥–µ–Ω–∏—è –Ω–∞–¥—Ç–∏–ø–∞ `any` (–ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å —Ä–µ—à—ë—Ç–∫–∞–º–∏), –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–º –≤ —Å–µ–±–µ `bool` –∏ `int` —Ä–∞–¥–∏ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –≤–≤–æ–¥–∞ –∏ –≤—ã–≤–æ–¥–∞ –¥–ª—è `bool`, –Ω–æ —ç—Ç–æ –≤—Å—ë –∂–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –≤–≤–µ–¥–µ–Ω–∏—è –µ—â—ë –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞ –∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫—É–¥–∞ –∏ –∫–∞–∫ –º—ã —Å–º–æ–∂–µ–º –ø–æ–¥–∞–≤–∞—Ç—å `any`:

- –ú–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å—Å—è —Ç–æ—á–Ω–æ—Å—Ç—å, –µ—Å–ª–∏ –º—ã —Ä–∞–∑—Ä–µ—à–∏–º `any` –≤ —É—Å–ª–æ–≤–∏—è—Ö ( –ø—Ä–∏—à—ë–ª `int` = 15, –º—ã —É–ø–∞–ª–∏ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —É—Å–ª–æ–≤–∏—è);
- –ú–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å—Å—è –ø–æ–ª–Ω–æ—Ç–∞, –µ—Å–ª–∏ –º—ã –∑–∞–ø—Ä–µ—Ç–∏–º `any` –≤ —É—Å–ª–æ–≤–∏—è—Ö (–ø—Ä–∏—à—ë–ª `any`, –∫–æ—Ç–æ—Ä—ã–π `int` = 1, –∞ –º—ã –∂–¥–∞–ª–∏ —Ç–æ–ª—å–∫–æ `bool`).

---

- –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –≤ –Ω–∞—à—É —Å–∏—Å—Ç–µ–º—É –≤–≤–µ—Å—Ç–∏ —Ç–∏–ø Array? –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –≤—ã–≤–æ–¥–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤, –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É:

```
main() {
    var x,y,z,t;
    x = {2,4,8,16,32,64};
    y = x[x[3]];
    z = {{},x};
    t = z[1];
    t[2] = y;
}
```

–ü–æ–ø—Ä–æ–±—É–µ–º –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø –º–∞—Å—Å–∏–≤–∞ $\tau$[], –≥–¥–µ $\tau$[] - —ç—Ç–æ:
- `int` - –º–∞—Å—Å–∏–≤ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π;
- `empty` - –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ (—Å—É–¥—è –ø–æ –ø—Ä–∏–º–µ—Ä—É –∫–æ–¥–∞, {});
- `$\tau$[]` - N-–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤.

–¢–æ–≥–¥–∞ $\tau E$ - –º–∞—Å—Å–∏–≤–∞ —Ç–∏–ø–∞ $E$.

| code                        | type                                                       |
|-----------------------------|------------------------------------------------------------|
| $E = \{ E_1, \dots, E_N \}$ | $\tau E = U(‚ü¶ E_1 ‚üß, \dots, ‚ü¶ E_N ‚üß) \land ‚ü¶E‚üß = \tau E[]$ |
| $E[X] = Y$                  | $\tau E = ‚ü¶Y‚üß \land ‚ü¶X‚üß = int$                             |
| $Y = E[X]$                  | $‚ü¶Y‚üß = \tau E \land ‚ü¶X‚üß = int$                             |

–¢–æ–≥–¥–∞ –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–π –≤—ã—à–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –ø–æ—Å–ª–µ —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```
main() {
    var x,y,z,t;
    x = {2,4,8,16,32,64};   ùúèx = U(int,int,int,int,int,int) = int; ‚ü¶x‚üß = int[]; 
    y = x[x[3]];            ùúèx = int; ‚ü¶y‚üß = int
    z = {{},x};             ùúèz = U(empty[],int[]) = int[]; ‚ü¶z‚üß = int[][]
    t = z[1];               ‚ü¶t‚üß = int[]
    t[2] = y;               ùúèt = int
}
```
 –í –∏—Ç–æ–≥–µ, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±—É–¥—É—Ç –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã:

 $$
 \begin{gather}
 ‚ü¶ x ‚üß = int[]\\
 ‚ü¶ y ‚üß = int\\
 ‚ü¶ z ‚üß = int[][]\\
 ‚ü¶ t ‚üß = int[]
 \end{gather}
 $$
 
---

### –ù–∞ –ø–æ–¥–µ–ª–∞—Ç—å:

---

- –î–æ–ø–∏—Å–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∫–ª–∞—Å—Å–∞ [TypeAnalysis](../src/tip/analysis/TypeAnalysis.scala). –ü–æ–¥—É–º–∞–π—Ç–µ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ø–æ–ª—É—á–∏–≤—à–µ–π—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –µ—Å–ª–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –µ—Å—Ç—å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–∏–ø?

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∏–º–µ—Ä `examples/foo.tip`:

```
foo(p,x) { 
    var f,q; 
    if (*p==0) { f=1; } 
    else { 
        q = alloc 0;
        *q = (*p)-1;
        f=(*p)*((x)(q,x));
    }
    return f;
}

main() {
    var n;
    n = input;
    return foo(&n,foo);
}
```

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–∏–ø –±—É–¥–µ—Ç —É —Ñ—É–Ω–∫—Ü–∏–∏ `foo` –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `x`.
–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞:

```
[info] Solution (not yet closed):
  ...
  ‚ü¶‚ü¶foo(p[1:5],x[1:7]){...}:1:1‚üß‚üß = (‚ü¶&n[15:16]‚üß,‚ü¶foo(p[1:5],x[1:7]){...}:1:1‚üß) -> ‚ü¶foo(&n,foo)[15:12]‚üß
  ...
  ‚ü¶‚ü¶x[1:7]‚üß‚üß = (‚ü¶&n[15:16]‚üß,‚ü¶foo(p[1:5],x[1:7]){...}:1:1‚üß) -> ‚ü¶foo(&n,foo)[15:12]‚üß
  ...
```

```
[info] Inferred types:
  ‚ü¶((*p) == 0)[3:11]‚üß = int
  ‚ü¶q[2:11]‚üß = ‚≠°int
  ‚ü¶&n[15:16]‚üß = ‚≠°int
  ‚ü¶(*p)[6:15]‚üß = int
  ‚ü¶p[1:5]‚üß = ‚≠°int
  ‚ü¶input[14:9]‚üß = int
  ‚ü¶1[6:19]‚üß = int
  ‚ü¶0[3:13]‚üß = int
  ‚ü¶((*p) - 1)[6:18]‚üß = int
  ‚ü¶n[13:9]‚üß = int
  ‚ü¶main(){...}:12:1‚üß = () -> int
  ‚ü¶0[5:19]‚üß = int
  ‚ü¶((*p) * x(q,x))[7:15]‚üß = int
  ‚ü¶x[1:7]‚üß = (‚≠°int,Œºx1.(‚≠°int,x1) -> int) -> int
  ‚ü¶foo(p[1:5],x[1:7]){...}:1:1‚üß = Œºx1.(‚≠°int,x1) -> int
  ‚ü¶foo(&n,foo)[15:12]‚üß = int
  ‚ü¶f[2:9]‚üß = int
  ‚ü¶(*p)[7:12]‚üß = int
  ‚ü¶(*p)[3:9]‚üß = int
  ‚ü¶alloc 0[5:13]‚üß = ‚≠°int
  ‚ü¶1[3:20]‚üß = int
  ‚ü¶x(q,x)[7:17]‚üß = int
```

–ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –æ–ø—Ä–µ–¥–µ–ª–∏–ª —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã —É `foo` –∏ `x`:
- `foo` - `Œºx1.(‚≠°int,x1) -> int`;
- `x` - `(‚≠°int,Œºx1.(‚≠°int,x1) -> int) -> int`.

–û–±–∞ —Ç–∏–ø–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ, –∏ –ø–æ–¥–æ–±–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–∏–∑–æ—à—ë–ª –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ —Å–Ω–∞—á–∞–ª–∞, –ø—Ä–∏ —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏, –±—ã–ª —Ä–∞—Å—Å—á–∏—Ç–∞–Ω —Ç–∏–ø `foo`, –∞ –∑–∞—Ç–µ–º –æ–Ω –ø—Ä–æ—Å—Ç–æ –±—ã–ª –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤–Ω—É—Ç—Ä—å –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è `x`.

